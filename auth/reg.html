<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Almost there - Calbiwe</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Manrope:wght@500&display=swap" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="shortcut icon" type="image/x-icon" href="../assets/logo.png" />
    <link rel="stylesheet" href="../index.css">
</head>
<body id="reg-body" class="auth-bg">
    <main class="auth-cont">
        <div class="auth-cont-left">
            
            <div class="auth-logo-cont">
                <div class="auth-img"> <img src="../assets/logo.gif" alt="logo" style="width: 50px;height: 50px;"></div>
                    <span class="auth-logo-text" style="color: tomato;">
                        Calbiwe
                    </span>
            </div>
            <img src="../assets/auth.webp" alt="" style="width: 500px;">
           </div>
        <div class="auth-cont-right">
            <div class="auth-logo-cont-form">
               
                <div class="auth-img-form"> <img src="../assets/logo.gif" alt="logo"></div>
                    <span class="auth-logo-text-form" style="color: tomato;">
                        Calbiwe
                    </span>
            </div>
            <div class="d-flex flex-column gap-1 w-100">
                <div class="auth-title" style="color: rgba(255, 99, 71, 0.904); font-size: 14px;">Create your hospital pass-codes</div>
                <div class="auth-title" style="color: teal;">Sign up</div>
            </div>
            
            <div class="auth-form  ">
                  <div class="form-floating auth-input-cont">
                    <input type="apassword" class="form-control" id="apassword" placeholder="aPassword">
                    <label id="apasslabel" for="apassword">Admin's password</label>
                  </div>
                  <div class="form-floating auth-input-cont">
                    <input type="spassword" class="form-control" id="spassword" placeholder="sPassword">
                    <label id="spasslabel" for="spassword">Staff's password</label>
                  </div>
                  <div class="form-floating auth-input-cont">
                    <input type="epassword" class="form-control" id="epassword" placeholder="ePassword">
                    <label id="epasslabel" for="epassword">Engineer's password</label>
                  </div>
                <button id="signup">Sign Up</button>
            </div>
            <div class="auth-signin-sub">
                <div class="auth-signin-sub-child" style="color: teal;">Already registered hospital? <a href="../index.html">Sign in</a></div>
            </div>
        </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script>
        $(document).ready(function () {
            $("#signup").click(function () {
                

                // Get user input
                var apassword = $("#apassword").val();
                var spassword = $("#spassword").val();
                var epassword = $("#epassword").val();
                var users = JSON.parse(localStorage.getItem("users")) || [];
                const hospital = localStorage.getItem("userh");

                // Validate inputs
                var isValid = true;
                $("#apassword").text("Admin's password");
                $("#spassword").text("Staff's password");
                $("#epassword").text("Engineer's password");

                if (apassword === "" || apassword.length < 6 || apassword === spassword || apassword === epassword ) {
                    $("#apasslabel").text("Password invalid*");
                    $("#apasslabel").css("color","tomato");
                    isValid = false;
                }

                if (spassword === "" || spassword.length < 6 || spassword === apassword || spassword === epassword ) {
                    $("#spasslabel").text("Password invalid*");
                    $("#spasslabel").css("color","tomato");
                    isValid = false;
                }

                if (epassword === "" || epassword.length < 6 || epassword === spassword || epassword === apassword ) {
                    $("#epasslabel").text("Password invalid*");
                    $("#epasslabel").css("color","tomato");
                    isValid = false;
                }

                // If validation passes, log user credentials to the console
                if (isValid) {
                    var user = {
                        apassword: apassword,
                        spassword: spassword,
                        epassword: epassword
                    };
                    console.log(user);
                      // Check if email already exists
                if (users.some(user => user.hospital === hospital)) {
                    const newParagra = $(`<div class="alert">
                        <i class="fa fa-check d-flex align-items-center  justify-content-center" style="width:40px;height:40px;color:white; border-radius:50%; background:teal;"></i>
        <div class="alert-text">Registered Successfully</div>
    </div>`);
    newParagra.css("top", "-50px");
                    $("#reg-body").append(newParagra);
                      // Use setTimeout to give the browser time to apply the initial top value
            setTimeout(function () {
                newParagra.css("top", "70px");
            }, 0);
                    setTimeout(function(){
      newParagra.remove();
      window.location.href="../index.html"
    }, 2000); 
                    
                } else {
                    const newParagraph = $(`<div class="alert">
        <i class="fa fa-exclamation d-flex align-items-center  justify-content-center" style="width:40px;height:40px;color:white; border-radius:50%; background:teal;"></i>
        <div class="alert-text-danger">No Hospital Found!</div>
    </div>`);
    newParagraph.css("top", "-50px");
                    $("#reg-body").append(newParagraph);
                       // Use setTimeout to give the browser time to apply the initial top value
            setTimeout(function () {
                newParagraph.css("top", "70px");
            }, 0);
                    setTimeout(function(){
      newParagraph.remove();
    }, 2000);         

                }
                }
            });
      // Function to validate email format
      function isValidEmail(email) {
                var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return emailRegex.test(email);
            }

        });
    </script>
</body>
</html>